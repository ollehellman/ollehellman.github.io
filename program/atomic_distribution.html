<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Temperature dependent effective potential 1.0">
    
    <meta name="author" content="Olle Hellman" >
    <link rel="icon" href="../favicon.png">

    <title>
    
        atomic distribution &ndash; TDEP
    
</title>

<!-- <link href="../css/bootstrap.min.css" rel="stylesheet"> -->
    <link href="../css/bootstrap.css" rel="stylesheet"> 
    <link href="../css/ollesfixes.css" rel="stylesheet"> 
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet"> 
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </head>

<body>
<div class="wrapper"><!-- my wrapper to make the footer stick at the bottom -->

<!-- Fixed navbar, defined in macros.html for some reason -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../index.html">TDEP <small>1.0</small></a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
            <!-- manual thingy -->
            
            <li><a href='../page/index.html'>Manual</a></li>
            
            <!-- programs -->
            <li>
            <a class="dropdown-toggle" data-toggle="dropdown" href="programs.html" id="programdropdown">Programs<span class="caret"></span></a>
            <ul class="dropdown-menu" aria-labelledby="apidropdown">
                
                    <li>
                        
                            <a href="../program/atomic_distribution.html">atomic distribution</a>
                        
                     </li>
                
                    <li>
                        
                            <a href='../program/autocorrelation.html'>autocorrelation</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/canonical_configuration.html">canonical configuration</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/crystal_structure_info.html">crystal structure info</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/extract_forceconstants.html">extract forceconstants</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/generate_structure.html">generate structure</a>
                        
                     </li>
                
                    <li>
                        
                            <a href='../program/lineshape.html'>lineshape</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/phonon_dispersion_relations.html">phonon dispersion relations</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/remap_forceconstant.html">remap forceconstant</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/samples_from_md.html">samples from md</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/thermal_conductivity.html">thermal conductivity</a>
                        
                     </li>
                
            </ul>
            </li>
            <!-- API -->
            <li>
            <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="apidropdown">API<span class="caret"></span></a>
            <ul class="dropdown-menu" aria-labelledby="apidropdown">
                
                <li><a href="../lists/files.html">Source Files</a></li>
                
                
                
                
                
            </ul>
            </li>
        </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
            <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
        </form>
        
        </div>
    </div>
</nav>

<div class="container-fluid">
    


</div>

<div class="jumbotron">
<div class="container-fluid">
    
        <h3>atomic distribution</h3>
    
</div>
</div>

<div class="container-fluid">
  <div class="row">
    <!--
    <div class="col-sm-2">
    
<div id="sidebar">
  





















  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprogs-0">All Programs</a></h3></div>
  <div id="allprogs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/atomic_distribution.html">atomic_distribution</a>
      
      <a class="list-group-item" href="../program/autocorrelation.html">autocorrelation</a>
      
      <a class="list-group-item" href="../program/canonical_configuration.html">canonical_configuration</a>
      
      <a class="list-group-item" href="../program/crystal_structure_info.html">crystal_structure_info</a>
      
      <a class="list-group-item" href="../program/extract_forceconstants.html">extract_forceconstants</a>
      
      <a class="list-group-item" href="../program/generate_structure.html">generate_structure</a>
      
      <a class="list-group-item" href="../program/lineshape.html">lineshape</a>
      
      <a class="list-group-item" href="../program/phonon_dispersion_relations.html">phonon_dispersion_relations</a>
      
      <a class="list-group-item" href="../program/remap_forceconstant.html">remap_forceconstant</a>
      
      <a class="list-group-item" href="../program/samples_from_md.html">samples_from_md</a>
      
      <a class="list-group-item" href="../program/thermal_conductivity.html">thermal_conductivity</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    -->
    
    <div class="col-sm-offset-2 col-sm-7 col-sm-offset-3" id='text'>
    <h3>Short description</h3>
<p>Calculates properties of the atomic distribution from molecular dynamics, such as mean square displacement, pair distribution function, vector distribution functions and probability densities. Useful for analysing simulations close to instabilities/phase transitions to have some idea where the atoms are.</p>
<h3>Command line options:</h3>
<p>Optional switches:</p>
<ul>
<li>
<p><code>--cutoff value</code>, <code>-r value</code><br>
    default value 5.0<br>
    Consider pairs up to this distance, in A.</p>
</li>
<li>
<p><code>--nbins value</code>, <code>-n value</code><br>
    default value 200<br>
    Number of bins in each dimension.</p>
</li>
<li>
<p><code>--notransform</code><br>
    default value .false.<br>
    Do no rotate the coordinate systems of the vector distribution. By default, the coordinate system is aligned with the positive x-direction in the direction of the bond.</p>
</li>
<li>
<p><code>--bintype value</code>, value in: <code>1,2,3</code><br>
    default value 1<br>
    Select the binning type for the vector distribution. 1 is straight binning (fastest), 2 is binning with a Gaussian, 3 is binning with a gaussian, but without the subpixel resolution.</p>
</li>
<li>
<p><code>--stride value</code>, <code>-s value</code><br>
    default value 1<br>
    Use every N configuration instead of all.</p>
</li>
<li>
<p><code>--help</code>, <code>-h</code><br>
    Print this help message</p>
</li>
<li>
<p><code>--version</code>, <code>-v</code><br>
    Print version</p>
</li>
</ul>
<h3>Examples</h3>
<p><code>atomic_distribution --cutoff 4.3</code> </p>
<p><code>atomic_distribution --cutoff 4.3 --notransform</code> </p>
<h3>Long description</h3>
<p>When using molecular dynamics, there are several ways to analyse the trajectories. This code implements a few of them. The TDEP method was originally meant to deal with dynamically unstable systems. It turns out the the most common problem for users was that the atoms did something during the simulation: what they thought was bcc Ti was no longer bcc Ti, but some halfway phase on it's way to transition to something.</p>
<p>So, before trying to get phonons and free energies and other things, it it useful to make sure that what is in your simulation box actually is what you think it is. A number of diagnostics is provided here.</p>
<h4>Some background</h4>
<p>The easiest measure is the mean square displacement:</p>
<p>$$
\textrm{msd}(t) = \frac{1}{N} \sum_i \left| \mathbf{r}_i(t)-\mathbf{r}_i(0) \right|^2
$$</p>
<p>where $\mathbf{r}_i(t)$ is the position of atom $i$ at time $t$. 
Having established that the system is at least still a solid we can look at the radial distribution function (or pair correlation function), defined as</p>
<p>$$
g(r) = \frac{ n(r) }{\rho 4 \pi r^2 dr}
$$</p>
<p>where $\rho$ is the mean particle density, and $n(r)$ the number of particles in an infinitesimal shell of width $dr$. Usually, this is averaged over all atoms in the system. In this code, I project it onto symmetrically equivalent pairs, yielding a projected pair distribution:</p>
<p>$$
g_i(r) = {\rho 4 \pi r^2 dr} \sum_i \delta\left( \left|r_i\right|-r \right)
$$</p>
<p>where the index $i$ corresponds to a coordination shell. The coordination shell is defined from the ideal lattice as set of pairs that can transform to each other via a spacegroup operation. Naturally, the sum over all projected PDFs yield the total.</p>
<p><center>
<img src="../media/scf_pdf.png" width="500" />
</center></p>
<p>Above is an example for ScF<sub>3</sub>. The peaks are well defined per pair, indicating that the system is still crystalline. In the projected picture, each coordination shell contributes one peak. Should on peak deviate strongly from a gaussian, it probably means that the system has undergone some internal shifts of the coordinates, altering the symmetry.</p>
<p>This code also calculates the vector distribution function, essentially three-dimensionsonal histograms of pair vectors. Schematically, it works like this: first I identify the symmetry inequivalent pair coordination shells (turqoise and blue arrows below). Each pair in the simulation cell gets a transformation associated with it (dashed lines) that takes them to the prototype vectors (connecting the dark blue atoms)</p>
<p><center>
<img src="../media/vectordist_ex_1.png" width="500" />
</center></p>
<p>With these transformation rules, every pair from every timestep gets transformed, and binned in a histogram. The histogram is attached to the ideal bond, so that the origin coincides with the equilibrium pair vector. The coordinate system is also rotated such that the positive $z$-direction coincides with the pair vector, see the sketch below. The blue dots represent samples from pairs associated with blue vectors above, same for the green dots.</p>
<p><center>
<img src="../media/vectordist_ex_2.png" width="500" />
</center></p>
<p>This results in three-dimensional distributions of pair vectors, one for each symmetry-distinct pair. This is a measure related to the pair correlation functions, but spatially resolved. If the distribution is given by $n(\mathbf{r})$, integrating this over spherical shells gives the pair correlation function described above. Using the same example as above, ScF<sub>3</sub>, isosurfaces of the distribution look like this for the nearest neighbour Sc-F pair:</p>
<p><center>
<img src="../media/vectordist_ex_3.png" width="500" />
</center></p>
<h3>Input files</h3>
<ul>
<li><a href="../page/files.html#infile.ucposcar">infile.ucposcar</a></li>
<li><a href="../page/files.html#infile.ssposcar">infile.ssposcar</a></li>
<li><a href="../page/files.html#infile.meta">infile.meta</a></li>
<li><a href="../page/files.html#infile.stat">infile.stat</a></li>
<li><a href="../page/files.html#infile.positions">infile.positions</a></li>
<li><a href="../page/files.html#infile.forces">infile.forces</a></li>
</ul>
<h3>Output files</h3>
<h4><code>outfile.mean_square_displacement.hdf5</code></h4>
<p>The hdf file is self-explainatory. In addition, a plain-text <code>outfile.mean_square_displacement</code> is written with</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td> 
    \( t_1 \qquad \textrm{msd}(t_1) \qquad \textrm{msd}_1(t_1) \qquad \ldots \qquad \textrm{msd}_{N_a}(t_1) \)
    </td>
</tr>
<tr>
    <td>2</td>
    <td> 
    \( t_2 \qquad \textrm{msd}(t_2) \qquad \textrm{msd}_1(t_2) \qquad \ldots \qquad \textrm{msd}_{N_a}(t_2) \)
    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>Where the columns are time (in fs), mean square displacement (in Ã…<sup>2</sup>), followed by the partial mean square displacement per unique atom.</p>
<h4><code>outfile.pair_distribution_function.hdf5</code></h4>
<p>The hdf file is self-explainatory. Below is a matlab snippet that produces the plot above</p>
<div class="codehilite"><pre><span></span><span class="n">clear</span> <span class="n">all</span><span class="p">;</span>
<span class="c">% filename</span>
<span class="n">fn</span><span class="p">=</span><span class="s">&#39;outfile.pair_distribution_function.hdf5&#39;</span><span class="p">;</span>
<span class="c">% number of unique atoms</span>
<span class="n">na</span><span class="p">=</span><span class="n">h5readatt</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/&#39;</span><span class="p">,</span><span class="s">&#39;number_unique_atoms&#39;</span><span class="p">);</span>
<span class="c">% the total</span>
<span class="n">x</span><span class="p">=</span><span class="n">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/r_axis&#39;</span><span class="p">);</span>
<span class="n">y</span><span class="p">=</span><span class="n">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/radial_pair_distribution_function&#39;</span><span class="p">);</span>
<span class="c">% the projected</span>
<span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span>
    <span class="n">xx</span><span class="p">{</span><span class="nb">i</span><span class="p">}=</span><span class="n">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,[</span><span class="s">&#39;/projected_r_axis_&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
    <span class="n">yy</span><span class="p">{</span><span class="nb">i</span><span class="p">}=</span><span class="n">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,[</span><span class="s">&#39;/projected_pair_distribution_function_atom_&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<span class="k">end</span>

<span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">clf</span><span class="p">;</span> <span class="n">hold</span> <span class="n">on</span><span class="p">;</span> <span class="n">box</span> <span class="n">on</span><span class="p">;</span>

<span class="c">% plot the total</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="c">% plot the projected</span>
<span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span>
<span class="k">for</span> <span class="nb">j</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">xx</span><span class="p">{</span><span class="nb">i</span><span class="p">},</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">{</span><span class="nb">i</span><span class="p">}(</span><span class="nb">j</span><span class="p">,:),</span><span class="n">yy</span><span class="p">{</span><span class="nb">i</span><span class="p">}(</span><span class="nb">j</span><span class="p">,:))</span>
<span class="k">end</span>
<span class="k">end</span>

<span class="n">set</span><span class="p">(</span><span class="n">gca</span><span class="p">,</span><span class="s">&#39;xminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;yminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (A)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;g(r)&#39;</span><span class="p">)</span>
</pre></div>


<p>and an equivalent snippet using matplotlib:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">h5py</span> <span class="kn">as</span> <span class="nn">h5</span>

<span class="c1"># open the sqe file</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;outfile.pair_distribution_function.hdf5&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="c1"># the total</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;r_axis&#39;</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;radial_pair_distribution_function&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># the projected</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;number_unique_atoms&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;projected_r_axis_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;projected_pair_distribution_function_atom_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">y</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance (A)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;g(r)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<h4><code>outfile.vector_distribution.hdf5</code></h4>
<p>This file contains all the vector distribution histograms, the prototype vectors, the transformations to the correct coordinate systems and so on. The file is self-documented. The following is the matlab snippet used to create the plot above:</p>
<div class="codehilite"><pre><span></span><span class="c">% file</span>
<span class="n">fn</span><span class="p">=</span><span class="s">&#39;outfile.vector_distribution.hdf5&#39;</span><span class="p">;</span>

<span class="c">% focus on one distribution, get the histogram</span>
<span class="n">gv</span><span class="p">=</span><span class="n">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/distribution_atom_1_shell_2&#39;</span><span class="p">);</span>
<span class="c">% and the coordinates for the bin-centers</span>
<span class="n">x</span><span class="p">=</span><span class="n">h5readatt</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/distribution_atom_1_shell_2&#39;</span><span class="p">,</span><span class="s">&#39;bincenters&#39;</span><span class="p">);</span>
<span class="c">% grids for plotting (always uniform)</span>
<span class="p">[</span><span class="n">gx</span><span class="p">,</span><span class="n">gy</span><span class="p">,</span><span class="n">gz</span><span class="p">]=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>

<span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">clf</span><span class="p">;</span> <span class="n">hold</span> <span class="n">on</span><span class="p">;</span>

<span class="c">% number of isosurfaces</span>
<span class="n">niv</span><span class="p">=</span><span class="mi">6</span><span class="p">;</span>
<span class="c">% values for the isosurfaces</span>
<span class="n">iv</span><span class="p">=</span><span class="nb">exp</span><span class="p">(</span> <span class="nb">linspace</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span><span class="nb">log</span><span class="p">(</span><span class="mf">1.5</span><span class="p">),</span><span class="n">niv</span><span class="p">)</span> <span class="p">);</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">hold</span> <span class="n">on</span><span class="p">;</span>

    <span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">niv</span>
       <span class="n">p</span> <span class="p">=</span> <span class="n">patch</span><span class="p">(</span><span class="n">isosurface</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span><span class="n">gy</span><span class="p">,</span><span class="n">gz</span><span class="p">,</span><span class="n">gv</span><span class="p">,</span><span class="n">iv</span><span class="p">(</span><span class="nb">i</span><span class="p">)));</span>
       <span class="n">isonormals</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span><span class="n">gy</span><span class="p">,</span><span class="n">gz</span><span class="p">,</span><span class="n">gv</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
       <span class="n">p</span><span class="p">.</span><span class="n">FaceColor</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.7</span> <span class="mf">0.1</span> <span class="mf">0.1</span><span class="p">];</span>
       <span class="n">p</span><span class="p">.</span><span class="n">EdgeColor</span> <span class="p">=</span> <span class="s">&#39;none&#39;</span><span class="p">;</span>
       <span class="n">alpha</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">0.25</span><span class="p">);</span>
    <span class="k">end</span>

    <span class="n">daspect</span><span class="p">([</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">view</span><span class="p">([</span><span class="mi">0</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">camlight</span><span class="p">;</span> <span class="n">lighting</span> <span class="n">phong</span>
    <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">zlabel</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">hold</span> <span class="n">on</span><span class="p">;</span>

<span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">iv</span><span class="p">)</span>
       <span class="n">p</span> <span class="p">=</span> <span class="n">patch</span><span class="p">(</span><span class="n">isosurface</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span><span class="n">gy</span><span class="p">,</span><span class="n">gz</span><span class="p">,</span><span class="n">gv</span><span class="p">,</span><span class="n">iv</span><span class="p">(</span><span class="nb">i</span><span class="p">)));</span>
       <span class="n">isonormals</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span><span class="n">gy</span><span class="p">,</span><span class="n">gz</span><span class="p">,</span><span class="n">gv</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
       <span class="n">p</span><span class="p">.</span><span class="n">FaceColor</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.7</span> <span class="mf">0.1</span> <span class="mf">0.1</span><span class="p">];</span>
       <span class="n">p</span><span class="p">.</span><span class="n">EdgeColor</span> <span class="p">=</span> <span class="s">&#39;none&#39;</span><span class="p">;</span>
       <span class="n">alpha</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">0.25</span><span class="p">);</span>
    <span class="k">end</span>

    <span class="n">daspect</span><span class="p">([</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">view</span><span class="p">([</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">camlight</span><span class="p">;</span> <span class="n">lighting</span> <span class="n">phong</span><span class="p">:</span>
    <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">zlabel</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">)</span>
</pre></div>


<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>I could not figure out an easy way to get decent-looking isosurfaces in matplotlib. Please tell me if you manage.</p></div>

<!--
    <br>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>constants</li>
      
      <li>type_crystalstructure</li>
      
      <li>type_mdsim</li>
      
      <li>type_symmetrytable</li>
      
      <li>type_symmetryoperation</li>
      
      <li>helpers</li>
      
      <li>dump_data</li>
      
      <li>options</li>
      
      <li>pairmapping</li>
      
      <li>vectordist</li>
      
      <li>pair_distribution</li>
      
      <li>mean_square_displacement</li>
      
      <li>timedistance_correlation</li>
      
      <li>correlationfunction</li>
      
    </ul>
    
    

    
    
    
    <br>

    
    
    
    
    
    
    

    
    
    


    
    
    
-->    
    </div>
  </div>

    <br>
    <br>
</div> <!-- /container -->

</div><!-- end of wrapper -->

<div class="footer">
<div class="container"> 
        <br>
        <div class="row">
            <div class="col-md-4">&copy; 2016 </div>
            <div class="col-md-4"><span class="text-center"> TDEP was developed by Olle Hellman</span></div>
            <div class="col-md-4"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a></span></div>
        </div>
        <br>
        <br>
</div>
</div>

    <!-- Bootstrap core JavaScript -->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>
    <!-- MathJax JavaScript -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
            TeX: { 
                extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], 
                equationNumbers: { autoNumber: 'AMS' } 
            },
            jax: ['input/TeX','input/MathML','output/HTML-CSS'],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            'HTML-CSS': { 
                styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
            }
        });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>